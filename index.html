<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø±ÙÙ‚ - Ù…Ù†Ø§Ù‡Ø¶Ø© Ø§Ù„Ø¹Ù†Ù | v2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Tajawal',system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .float-animation{animation:float 3s ease-in-out infinite}
    .float-animation:nth-child(2){animation-delay:.5s}
    .float-animation:nth-child(3){animation-delay:1s}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
    .pulse-heart{animation:pulse-heart 2s ease-in-out infinite}
    @keyframes pulse-heart{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
    .card-hover{transition:all .3s ease}
    .card-hover:hover{transform:translateY(-5px);box-shadow:0 20px 40px rgba(0,0,0,.1)}
    .print-a4 *{-webkit-print-color-adjust:exact;print-color-adjust:exact}
    @media print{
      .no-print{display:none!important}
      a[href^="http"]::after{content:" ğŸ”—";}
      a[href^="tel:"]::after{content:" â˜";}
      a[href^="mailto:"]::after{content:" âœ‰";}
      a[href*=".pdf"]::after{content:" ğŸ“„";}
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen">
  <!-- Sticky Header with school identity -->
  <header class="bg-white/80 backdrop-blur border-b sticky top-0 z-40">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-4">
      <img id="schoolLogo" src="" alt="Ø´Ø¹Ø§Ø±" class="w-12 h-12 rounded-xl object-cover border hidden"/>
      <div class="text-sm leading-5">
        <div class="font-bold text-gray-800" id="ministryName">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
        <div class="text-gray-600" id="eduAdmin">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…: â€”</div>
        <div class="text-gray-600" id="schoolName">Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: â€”</div>
      </div>
      <div class="ms-auto flex items-center gap-2">
        <button class="no-print text-sm px-3 py-1.5 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white" onclick="openSettings()">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ±ÙˆÙŠØ³Ø©</button>
        <button class="no-print text-sm px-3 py-1.5 rounded-lg bg-purple-600 hover:bg-purple-700 text-white" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙØ­Ø©</button>
        <div class="no-print inline-flex gap-2">
          <button class="text-sm px-3 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white" onclick="downloadFullPagePDF('portrait')">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© PDF (Ø·ÙˆÙ„ÙŠ/ØªÙØ§Ø¹Ù„ÙŠ)</button>
          <button class="text-sm px-3 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white" onclick="downloadFullPagePDF('landscape')">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© PDF (Ø¹Ø±Ø¶ÙŠ/ØªÙØ§Ø¹Ù„ÙŠ)</button>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="text-center py-8">
    <div class="inline-flex items-center justify-center mb-3"><div class="text-6xl pulse-heart">ğŸ’</div></div>
    <h1 class="text-5xl font-extrabold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-fuchsia-600 to-teal-600">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø±ÙÙ‚</h1>
    <p class="text-2xl text-gray-700">Ù„Ù…Ù†Ø§Ù‡Ø¶Ø© Ø§Ù„Ø¹Ù†Ù ÙÙŠ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</p>
    <div class="flex justify-center gap-4 mt-4">
      <span class="text-3xl float-animation">ğŸŒŸ</span>
      <span class="text-3xl float-animation">ğŸ¤</span>
      <span class="text-3xl float-animation">ğŸŒˆ</span>
    </div>
  </section>

  <main class="max-w-6xl mx-auto px-4 pb-16">
    <!-- Quick actions -->
    <div class="grid sm:grid-cols-3 gap-3 mb-6">
      <button class="no-print bg-gradient-to-r from-rose-500 to-pink-500 text-white rounded-2xl py-3 font-bold shadow-lg hover:from-rose-600 hover:to-pink-600" onclick="openReportModal()">ğŸ“¢ Ø¨Ù„Ø§Øº Ø¯Ø§Ø®Ù„ÙŠ Ø¢Ù…Ù†</button>
      <button class="no-print bg-gradient-to-r from-amber-500 to-yellow-500 text-white rounded-2xl py-3 font-bold shadow-lg hover:from-amber-600 hover:to-yellow-600" onclick="openPledge()">ğŸ“ Ø·Ø¨Ø§Ø¹Ø© Ø¹Ù‡Ø¯ Ø±ÙÙ‚</button>
      <button class="no-print bg-gradient-to-r from-indigo-500 to-cyan-500 text-white rounded-2xl py-3 font-bold shadow-lg hover:from-indigo-600 hover:to-cyan-600" onclick="openCertificate()">ğŸ–ï¸ Ø´Ù‡Ø§Ø¯Ø© Ø³ÙÙŠØ±/Ø© Ø±ÙÙ‚</button>
    </div>

    <!-- Intro card -->
    <div class="bg-white rounded-3xl shadow-xl p-8 mb-8 card-hover text-center">
      <div class="text-8xl mb-4">ğŸ«</div>
      <h2 class="text-3xl font-bold text-gray-800 mb-3">Ù…Ø¯Ø±Ø³Ø© Ø¢Ù…Ù†Ø© ÙˆÙˆØ¯ÙˆØ¯Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹</h2>
      <p class="text-lg text-gray-600 leading-relaxed">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø±ÙÙ‚ ÙŠÙ‡Ø¯Ù Ø¥Ù„Ù‰ Ø®Ù„Ù‚ Ø¨ÙŠØ¦Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¢Ù…Ù†Ø© ÙˆØ¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¹Ù†Ù ÙˆØ§Ù„ØªÙ†Ù…Ø± Ø¹Ø¨Ø± Ø§Ù„ØªÙˆØ¹ÙŠØ©ØŒ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ©ØŒ ÙˆØ§Ù„ØªØ¯Ø®Ù„ Ø§Ù„Ù…Ø¨ÙƒØ±.</p>
    </div>

    <!-- CTA -->
    <section id="ctaSection" class="bg-gradient-to-r from-orange-100 to-yellow-100 rounded-3xl p-8 text-center card-hover mb-12 relative">
      <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© -->
      <a href="https://123456789fh.github.io/Gentleness/"
         target="_blank" rel="noopener noreferrer"
         class="no-print hidden md:flex items-center justify-center absolute -top-5 -right-5 w-16 h-16 rounded-2xl bg-rose-500 text-white shadow-lg ring-4 ring-white/70 hover:scale-105 transition"
         aria-label="ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±ÙÙ‚" title="ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±ÙÙ‚">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M12.1 21.35l-1.1-.99C5.14 15.36 2 12.5 2 9.28 2 7.01 3.79 5.2 6.05 5.2c1.38 0 2.73.64 3.6 1.7.87-1.06 2.22-1.7 3.6-1.7 2.26 0 4.05 1.81 4.05 4.08 0 3.22-3.14 6.08-8.9 11.08l-1.3 1z"/>
        </svg>
      </a>

      <div class="text-6xl mb-2">ğŸŒŸ</div>
      <h2 class="text-3xl font-bold text-orange-800 mb-3">Ø§Ù†Ø¶Ù…Ù‘ÙŠ Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ø±ÙÙ‚</h2>
      <p class="text-lg text-orange-700 mb-5">Ù…Ø¹Ù‹Ø§ Ù†Ø¨Ù†ÙŠ Ù…Ø¯Ø±Ø³Ø© Ø£Ø¬Ù…Ù„ ÙˆØ£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ù‹Ø§ Ù„Ù„Ø¬Ù…ÙŠØ¹</p>
      <div class="flex flex-wrap justify-center gap-3 mb-4">
        <a href="https://padlet.com/harthy298/Kindness" target="_blank" rel="noopener" class="no-print bg-gradient-to-r from-pink-500 to-purple-500 text-white px-6 py-2 rounded-full font-bold text-lg hover:from-pink-600 hover:to-purple-600 transform hover:scale-105 transition">Ø£Ø±Ø³Ù„ÙˆØ§ Ù…Ø´Ø§Ø±ÙƒØ§ØªÙƒÙ… ğŸ“</a>
        <button onclick="openInfo()" class="no-print bg-gradient-to-r from-blue-500 to-teal-500 text-white px-6 py-2 rounded-full font-bold text-lg hover:from-blue-600 hover:to-teal-600 transform hover:scale-105 transition">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ ğŸ“</button>
        <a href="https://123456789fh.github.io/Gentleness/" target="_blank" rel="noopener" class="no-print inline-flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2 rounded-full font-bold text-lg transform hover:scale-105 transition">ğŸ’ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±ÙÙ‚</a>
      </div>
      <div class="text-sm text-gray-700">
        <p>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©: Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª â€¢ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª â€¢ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</p>
        <p class="mt-1 font-medium text-purple-700">Ø¥Ø´Ø±Ø§Ù: Ø£/ ÙØ§Ø·Ù…Ø© Ù‡Ø²Ø§Ø²ÙŠ</p>
      </div>
    </section>

    <!-- Reports table -->
    <section id="reportsSection" class="bg-white rounded-3xl shadow p-6 mb-12">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-bold text-gray-800">Ø³Ø¬Ù„ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© (Ù…Ø­ÙÙˆØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§)</h3>
        <div class="no-print space-x-2 space-x-reverse">
          <button class="px-3 py-1.5 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white" onclick="exportReports()">â¬‡ï¸ ØªØµØ¯ÙŠØ± CSV</button>
          <button class="px-3 py-1.5 rounded-lg bg-rose-600 hover:bg-rose-700 text-white" onclick="clearReports()">ğŸ§¹ Ù…Ø³Ø­</button>
        </div>
      </div>
      <div class="overflow-auto">
        <table class="w-full text-sm">
          <thead class="bg-gray-100 text-gray-700">
            <tr>
              <th class="px-3 py-2 text-right">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th class="px-3 py-2 text-right">Ø§Ù„ØµÙ/Ø§Ù„ÙØµÙ„</th>
              <th class="px-3 py-2 text-right">Ø§Ù„Ù…ÙƒØ§Ù†</th>
              <th class="px-3 py-2 text-right">Ø§Ù„Ù†ÙˆØ¹</th>
              <th class="px-3 py-2 text-right">ÙˆØµÙ Ù…ÙˆØ¬Ø²</th>
              <th class="px-3 py-2 text-right">Ø¥Ø¬Ø±Ø§Ø¡ ÙÙˆØ±ÙŠ</th>
              <th class="px-3 py-2 text-right">Ø¥Ø­Ø§Ù„Ø©</th>
            </tr>
          </thead>
          <tbody id="reportsBody" class="divide-y"></tbody>
        </table>
      </div>
      <p class="text-xs text-gray-500 mt-3">ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ÙÙ‚Ø· (localStorage). Ù„Ø§ ÙŠØªÙ… Ø±ÙØ¹ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø®Ø§Ø¯Ù….</p>
    </section>

    <!-- Official help -->
    <section class="bg-gradient-to-r from-sky-100 to-blue-100 rounded-3xl p-6">
      <h3 class="text-xl font-bold text-blue-800 mb-3">Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø³Ø§Ù†Ø¯Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©</h3>
      <ul class="space-y-2 text-sm text-blue-900">
        <li>ğŸ“ <strong>Ø®Ø· Ù…Ø±ÙƒØ² Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø¹Ù†Ù Ø§Ù„Ø£Ø³Ø±ÙŠ (ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©)</strong>: <a class="underline" href="tel:1919">1919</a></li>
        <li>ğŸ“ <strong>Ø®Ø· Ù…Ø³Ø§Ù†Ø¯Ø© Ø§Ù„Ø·ÙÙ„</strong>: <a class="underline" href="tel:116111">116111</a></li>
        <li>ğŸ“ <strong>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ­Ø¯ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦</strong>: <a class="underline" href="tel:911">911</a></li>
      </ul>
      <p class="text-xs text-blue-800/80 mt-2">Ù„Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø© Ø£Ùˆ Ø§Ù„ØªÙŠ ØªØªØ·Ù„Ø¨ ØªØ¯Ø®Ù„Ù‹Ø§ ÙÙˆØ±ÙŠÙ‹Ø§ØŒ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù„Ø§ØªØµØ§Ù„ Ø¹Ù„Ù‰ 911.</p>
    </section>

    <!-- Footer -->
    <footer class="text-center mt-10 text-gray-500">
      <div class="flex justify-center gap-2 mb-2 text-2xl"><span>ğŸ’</span><span>ğŸ¤</span><span>ğŸŒˆ</span><span>ğŸ«</span><span>âœ¨</span></div>
      <p class="text-lg font-medium">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø±ÙÙ‚ - Ù…Ù† Ø£Ø¬Ù„ Ù…Ø³ØªÙ‚Ø¨Ù„ Ø£ÙØ¶Ù„ Ù„Ø£Ø·ÙØ§Ù„Ù†Ø§</p>
      <p class="text-sm mt-1" id="footerLine"></p>
    </footer>
  </main>

  <!-- Generic Info Modal -->
  <div id="infoModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 max-w-md mx-4 text-center">
      <div class="text-5xl mb-3">ğŸ“¬</div>
      <p class="text-base text-gray-800 mb-5">Ù„Ù„ØªÙˆØ§ØµÙ„: Ø±Ø§Ø¬Ø¹ÙˆØ§ Ø§Ù„Ù…Ø±Ø´Ø¯Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ© Ø£Ùˆ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©. Ù„Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø© Ø§ØªØµÙ„ÙˆØ§ Ø¹Ù„Ù‰ <strong>911</strong>.</p>
      <button class="bg-gradient-to-r from-green-600 to-blue-600 text-white px-5 py-2 rounded-full font-bold" onclick="closeInfo()">Ø­Ø³Ù†Ø§Ù‹</button>
    </div>
  </div>

  <!-- Report Modal -->
  <div id="reportModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 max-w-2xl w-[92%] mx-4">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-bold">Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù„Ø§Øº Ø¯Ø§Ø®Ù„ÙŠ</h3>
        <button class="text-gray-500 hover:text-gray-700" onclick="closeReportModal()">âœ–</button>
      </div>
      <form id="reportForm" class="grid sm:grid-cols-2 gap-3 text-sm">
        <label class="block">Ø§Ù„ØªØ§Ø±ÙŠØ®<input required type="date" name="date" class="mt-1 w-full border rounded-lg px-3 py-2"></label>
        <label class="block">Ø§Ù„ØµÙ/Ø§Ù„ÙØµÙ„<input required type="text" name="class" placeholder="6/Ø£" class="mt-1 w-full border rounded-lg px-3 py-2"></label>
        <label class="block">Ø§Ù„Ù…ÙƒØ§Ù†<select name="place" class="mt-1 w-full border rounded-lg px-3 py-2"><option>Ø§Ù„ÙØµÙ„</option><option>Ø§Ù„Ø³Ø§Ø­Ø©</option><option>Ø§Ù„Ù…Ù…Ø±</option><option>Ø§Ù„Ù…Ù‚ØµÙ</option><option>Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª/Ù…Ù†ØµØ§Øª</option></select></label>
        <label class="block">Ù†ÙˆØ¹ Ø§Ù„Ø³Ù„ÙˆÙƒ<select name="type" class="mt-1 w-full border rounded-lg px-3 py-2"><option>Ù„ÙØ¸ÙŠ</option><option>Ø¬Ø³Ø¯ÙŠ</option><option>ØªÙ†Ù…Ù‘Ø±/ØªÙƒØ±Ø§Ø±</option><option>Ø¥Ù‚ØµØ§Ø¡ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</option><option>Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</option><option>ØªÙ„Ù Ù…Ù…ØªÙ„ÙƒØ§Øª</option></select></label>
        <label class="block sm:col-span-2">ÙˆØµÙ Ù…ÙˆØ¬Ø²<textarea name="desc" rows="3" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="Ù…Ø§Ø°Ø§ Ø­Ø¯Ø« Ø¨Ø¥ÙŠØ¬Ø§Ø²ØŸ"></textarea></label>
        <div class="sm:col-span-2 flex justify-end gap-2 mt-2">
          <button type="button" class="px-4 py-2 rounded-lg bg-gray-200" onclick="closeReportModal()">Ø¥Ù„ØºØ§Ø¡</button>
          <button class="px-4 py-2 rounded-lg bg-indigo-600 text-white">Ø­ÙØ¸ Ø§Ù„Ø¨Ù„Ø§Øº</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Pledge Modal -->
  <div id="pledgeModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 w-[92%] max-w-3xl print-a4">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-bold">Ø¹Ù‡Ø¯ Ø±ÙÙ‚</h3>
        <div class="no-print flex items-center gap-2">
          <label class="text-sm flex items-center gap-2">
            <span>ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©:</span>
            <select id="pledgeOrientation" class="border rounded-lg px-2 py-1">
              <option value="portrait">Ø·ÙˆÙ„ÙŠ (Ø§ÙØªØ±Ø§Ø¶ÙŠ)</option>
              <option value="landscape">Ø¹Ø±Ø¶ÙŠ</option>
            </select>
          </label>
          <button class="px-4 py-2 rounded-lg bg-emerald-600 text-white" onclick="printElement('#pledgeContent', document.getElementById('pledgeOrientation').value)">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
          <button class="px-4 py-2 rounded-lg bg-blue-600 text-white" onclick="downloadPDF('#pledgeContent', document.getElementById('pledgeOrientation').value, 'Ø¹Ù‡Ø¯-Ø±ÙÙ‚.pdf')">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ PDF</button>
          <button class="text-gray-500" onclick="closePledge()">âœ–</button>
        </div>
      </div>
      <div id="pledgeContent" class="bg-white rounded-2xl border p-8 text-center leading-8">
        <h4 class="text-2xl font-extrabold mb-3">ğŸ’ Ø¹Ù‡Ø¯ Â«Ø±ÙÙ‚Â»</h4>
        <p class="text-lg">Ø£Ù†Ø§ .................................. Ø£ØªØ¹Ù‡Ø¯ Ø£Ù† ØªÙƒÙˆÙ† ÙƒÙ„Ù…Ø§ØªÙŠ Ù„Ø·ÙŠÙØ©ØŒ ÙˆÙŠØ¯ÙŠ Ø¢Ù…Ù†Ø©ØŒ ÙˆÙ‚Ù„Ø¨ÙŠ Ø±Ø­ÙŠÙ…Ù‹Ø§ØŒ ÙˆØ¥Ø°Ø§ ØªØ¹Ø±Ù‘Ø¶ØªÙ Ø£Ùˆ Ø´Ø§Ù‡Ø¯ØªÙ Ø¹Ù†ÙÙ‹Ø§ ÙØ³Ø£ÙØ¨Ù„Ù‘ÙØº ÙÙˆØ±Ù‹Ø§ Ø¨Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©.</p>
        <div class="grid grid-cols-2 gap-6 mt-8 text-sm">
          <div class="border rounded-xl p-4"><div class="font-bold">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</div><div class="h-8 border-b"></div></div>
          <div class="border rounded-xl p-4"><div class="font-bold">Ø§Ù„ØªØ§Ø±ÙŠØ®</div><div class="h-8 border-b"></div></div>
          <div class="border rounded-xl p-4 col-span-2"><div class="font-bold">ØªÙˆÙ‚ÙŠØ¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±/Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</div><div class="h-8 border-b"></div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Certificate Modal -->
  <div id="certModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 w-[92%] max-w-3xl print-a4">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-bold">Ø´Ù‡Ø§Ø¯Ø© Ø³ÙÙŠØ±/Ø© Ø±ÙÙ‚</h3>
        <div class="no-print flex items-center gap-2">
          <input id="certName" type="text" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©" class="border rounded-lg px-3 py-2" oninput="updateCert()" />
          <label class="text-sm flex items-center gap-2">
            <span>ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©:</span>
            <select id="certOrientation" class="border rounded-lg px-2 py-1">
              <option value="portrait">Ø·ÙˆÙ„ÙŠ (Ø§ÙØªØ±Ø§Ø¶ÙŠ)</option>
              <option value="landscape">Ø¹Ø±Ø¶ÙŠ</option>
            </select>
          </label>
          <button class="px-4 py-2 rounded-lg bg-emerald-600 text-white" onclick="printElement('#certPaper', document.getElementById('certOrientation').value)">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
          <button class="px-4 py-2 rounded-lg bg-blue-600 text-white" onclick="downloadPDF('#certPaper', document.getElementById('certOrientation').value, 'Ø´Ù‡Ø§Ø¯Ø©-Ø³ÙÙŠØ±-Ø±ÙÙ‚.pdf')">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ PDF</button>
          <button class="text-gray-500" onclick="closeCertificate()">âœ–</button>
        </div>
      </div>
      <div id="certPaper" class="bg-white rounded-2xl border p-8 text-center">
        <div class="text-5xl mb-2">ğŸ–ï¸</div>
        <h4 class="text-2xl font-extrabold mb-1">Ø´Ù‡Ø§Ø¯Ø© Â«Ø³ÙÙŠØ±/Ø© Ø±ÙÙ‚Â»</h4>
        <p class="text-gray-700">ØªÙ…Ù†Ø­ Ù„Ù„Ø·Ø§Ù„Ø¨Ø©</p>
        <div class="text-3xl font-extrabold my-3" id="certNamePreview">â€”</div>
        <p class="text-gray-700">Ù†Ø¸ÙŠØ± Ù…Ø¨Ø§Ø¯Ø±ØªÙ‡Ø§ ÙÙŠ Ù†Ø´Ø± Ø§Ù„Ù„Ø·Ù ÙˆÙ…Ø³Ø§Ù†Ø¯Ø© Ø²Ù…ÙŠÙ„Ø§ØªÙ‡Ø§ ÙˆØ§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¢Ù…Ù†.</p>
        <div class="grid grid-cols-2 gap-6 mt-8 text-sm">
          <div class="text-left">Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="today"></span></div>
          <div class="text-right">ØªÙˆÙ‚ÙŠØ¹: ______________________</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal (Header + Footer) -->
  <div id="settingsModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 w-[92%] max-w-2xl">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-bold">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© ÙˆØ§Ù„ØªØ°ÙŠÙŠÙ„</h3>
        <button class="text-gray-500" onclick="closeSettings()">âœ–</button>
      </div>
      <form id="settingsForm" class="grid sm:grid-cols-2 gap-3 text-sm">
        <label class="block">ÙˆØ²Ø§Ø±Ø©/Ø¬Ù‡Ø©<input type="text" name="ministry" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…"></label>
        <label class="block">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…<input type="text" name="edu" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… â€”"></label>
        <label class="block sm:col-span-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<input type="text" name="school" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="Ù…Ø¯Ø±Ø³Ø© â€” Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©"></label>
        <label class="block sm:col-span-2">Ø±Ø§Ø¨Ø· Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)<input type="url" name="logo" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="https://..."></label>
        <label class="block sm:col-span-2">Ø§Ø³Ù… Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ù„Ù„ØªØ°ÙŠÙŠÙ„)<input type="text" name="principal" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="â€”"></label>
        <label class="block sm:col-span-2">Ù†Øµ Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù…Ø®ØµØµ<input type="text" name="footer" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§ Ù„ÙŠØ¸Ù‡Ø±: Ø¨Ø±Ù…Ø¬Ø©: Ø£/ ÙØ§Ø·Ù…Ø© Ù‡Ø²Ø§Ø²ÙŠ"></label>
        <label class="block sm:col-span-2">Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ°ÙŠÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)<input type="url" name="footerLink" class="mt-1 w-full border rounded-lg px-3 py-2" placeholder="https://example.com"></label>
        <div class="sm:col-span-2 flex justify-end gap-2 mt-2">
          <button type="button" class="px-4 py-2 rounded-lg bg-gray-200" onclick="closeSettings()">Ø¥Ù„ØºØ§Ø¡</button>
          <button class="px-4 py-2 rounded-lg bg-indigo-600 text-white">Ø­ÙØ¸</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    (function(){
      var s1=document.createElement('script'); s1.src='https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'; s1.defer=true; document.head.appendChild(s1);
      var s2=document.createElement('script'); s2.src='https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'; s2.defer=true; document.head.appendChild(s2);
    })();

    async function downloadPDF(sel, orientation, filename){
      return downloadForSelector(sel, orientation, filename);
    }
    async function downloadFullPagePDF(orientation){
      return downloadForSelector('body', orientation, 'Ø§Ù„ØµÙØ­Ø©-ÙƒØ§Ù…Ù„Ø©.pdf', true);
    }

    async function downloadForSelector(sel, orientation, filename, wholePage){
      try{
        const root = sel==='body' ? document.body : document.querySelector(sel);
        if(!root){ alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰'); return; }
        if (document.fonts && document.fonts.ready) { await document.fonts.ready; }
        async function ensureLibs(){
          if (window.html2canvas && window.jspdf) return true;
          await new Promise(r=>setTimeout(r,120));
          return ensureLibs();
        }
        await ensureLibs();

        const { jsPDF } = window.jspdf;
        const pageW = (orientation==='landscape') ? 297 : 210;
        const pageH = (orientation==='landscape') ? 210 : 297;
        const margin = 10;
        const contentW = pageW - margin*2;
        const contentH = pageH - margin*2;

        const docW = wholePage
          ? Math.max(document.documentElement.scrollWidth, document.body.scrollWidth)
          : root.getBoundingClientRect().width;
        const docH = wholePage
          ? Math.max(document.documentElement.scrollHeight, document.body.scrollHeight)
          : root.getBoundingClientRect().height;

        const scale = Math.min(3, Math.max(2, window.devicePixelRatio||2));
        const canvas = await html2canvas(root, {
          scale, useCORS:true, backgroundColor:'#ffffff',
          windowWidth: wholePage ? docW : undefined,
          windowHeight: wholePage ? docH : undefined,
          scrollX: wholePage ? -window.scrollX : undefined,
          scrollY: wholePage ? -window.scrollY : undefined
        });

        const mmPerPx = contentW / canvas.width;
        const slicePx = Math.floor(contentH / mmPerPx);
        const totalPages = Math.max(1, Math.ceil(canvas.height / slicePx));

        const pdf = new jsPDF({ orientation: orientation || 'portrait', unit:'mm', format:'a4' });

        function addSlice(pageIndex){
          const sy = pageIndex * slicePx;
          const sh = Math.min(slicePx, canvas.height - sy);
          const pageCanvas = document.createElement('canvas');
          pageCanvas.width = canvas.width;
          pageCanvas.height = sh;
          const ctx = pageCanvas.getContext('2d');
          ctx.drawImage(canvas, 0, sy, canvas.width, sh, 0, 0, canvas.width, sh);
          const imgData = pageCanvas.toDataURL('image/jpeg', 0.98);
          const imgH_mm = sh * mmPerPx;
          if(pageIndex>0) pdf.addPage();
          pdf.addImage(imgData, 'JPEG', margin, margin, contentW, imgH_mm, undefined, 'FAST');
        }

        const anchors = Array.from(root.querySelectorAll('a[href]'));
        const rootRect = root.getBoundingClientRect();
        const rootTopPx = (wholePage ? 0 : (rootRect.top + window.scrollY));
        const rootLeftPx = (wholePage ? 0 : (rootRect.left + window.scrollX));

        const annotsByPage = Array.from({length: totalPages}, () => []);

        anchors.forEach(a=>{
          let href = a.getAttribute('href') || '';
          try { href = new URL(href, location.href).href; } catch(e){}
          if (!/^https?:|^mailto:|^tel:/.test(href)) return;
          const r = a.getBoundingClientRect();
          const absLeft = r.left + window.scrollX - rootLeftPx;
          const absTop  = r.top  + window.scrollY - rootTopPx;
          const mmPerPxLocal = mmPerPx;
          const pageIndex = Math.floor(absTop / slicePx);
          const x_mm = margin + absLeft * mmPerPxLocal;
          const y_mm = margin + (absTop - pageIndex*slicePx) * mmPerPxLocal;
          const w_mm = Math.max(6, r.width  * mmPerPxLocal);
          const h_mm = Math.max(6, r.height * mmPerPxLocal);
          if(pageIndex>=0 && pageIndex<totalPages){
            annotsByPage[pageIndex].push({x:x_mm,y:y_mm,w:w_mm,h:h_mm,url:href});
          }
        });

        for(let i=0;i<totalPages;i++){
          addSlice(i);
          (annotsByPage[i]||[]).forEach(L=>{ try{ pdf.link(L.x,L.y,L.w,L.h,{url:L.url}); }catch(e){} });
        }

        pdf.save(filename || 'document.pdf');
      }catch(e){
        console.error(e);
        alert('ØªØ¹Ø°Ù‘Ø± Ø¥Ù†Ø´Ø§Ø¡ PDF ØªÙØ§Ø¹Ù„ÙŠ Ù„Ù„ØµÙØ­Ø©.');
      }
    }

    // Info modal
    function openInfo(){document.getElementById('infoModal').classList.remove('hidden');document.getElementById('infoModal').classList.add('flex')}
    function closeInfo(){document.getElementById('infoModal').classList.add('hidden');document.getElementById('infoModal').classList.remove('flex')}

    // Report modal
    function openReportModal(){document.getElementById('reportModal').classList.remove('hidden');document.getElementById('reportModal').classList.add('flex')}
    function closeReportModal(){document.getElementById('reportModal').classList.add('hidden');document.getElementById('reportModal').classList.remove('flex')}

    // Pledge modal
    function openPledge(){document.getElementById('pledgeModal').classList.remove('hidden');document.getElementById('pledgeModal').classList.add('flex')}
    function closePledge(){document.getElementById('pledgeModal').classList.add('hidden');document.getElementById('pledgeModal').classList.remove('flex')}

    // Certificate modal
    function openCertificate(){document.getElementById('certModal').classList.remove('hidden');document.getElementById('certModal').classList.add('flex')}
    function closeCertificate(){document.getElementById('certModal').classList.add('hidden');document.getElementById('certModal').classList.remove('flex')}
    function updateCert(){document.getElementById('certNamePreview').textContent=document.getElementById('certName').value||'â€”'}

    // Settings modal
    function openSettings(){
      document.getElementById('settingsModal').classList.remove('hidden');
      document.getElementById('settingsModal').classList.add('flex');
      const s=JSON.parse(localStorage.getItem('rifqSettings')||'{}');
      document.querySelector('#settingsForm [name=ministry]').value=s.ministry||document.getElementById('ministryName').textContent;
      document.querySelector('#settingsForm [name=edu]').value=s.edu||document.getElementById('eduAdmin').textContent.replace('Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…: ','');
      document.querySelector('#settingsForm [name=school]').value=s.school||document.getElementById('schoolName').textContent.replace('Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: ','');      
      document.querySelector('#settingsForm [name=logo]').value=s.logo||'';
      document.querySelector('#settingsForm [name=principal]').value=s.principal||'';
      document.querySelector('#settingsForm [name=footer]').value=s.footer||'';
      document.querySelector('#settingsForm [name=footerLink]').value=s.footerLink||'';
    }
    function closeSettings(){document.getElementById('settingsModal').classList.add('hidden');document.getElementById('settingsModal').classList.remove('flex')}

    // Print via iframe (icons appear after links)
    function printElement(sel, orientation){
      const el=document.querySelector(sel);
      const content = el ? el.outerHTML : '<div style="padding:20mm;text-align:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©.</div>';
      const html = `<!DOCTYPE html><html dir="rtl"><head><meta charset="utf-8"><title>Ø·Ø¨Ø§Ø¹Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  body{font-family:Tajawal,system-ui,Arial;margin:0;padding:0;direction:rtl}
  @page{size:A4 ${orientation||'portrait'}; margin:15mm}
  .print-a4 *{-webkit-print-color-adjust:exact;print-color-adjust:exact}
  a[href^="http"]::after{content:" ğŸ”—";} a[href^="tel:"]::after{content:" â˜";} a[href^="mailto:"]::after{content:" âœ‰";} a[href*=".pdf"]::after{content:" ğŸ“„";}
  .border{border:1px solid #e5e7eb} .border-b{border-bottom:1px solid #e5e7eb}
  .rounded-xl{border-radius:0.75rem} .rounded-2xl{border-radius:1rem}
  .p-4{padding:1rem} .p-8{padding:2rem} .mt-8{margin-top:2rem} .mb-3{margin-bottom:.75rem}
  .text-center{text-align:center} .text-left{text-align:left} .text-right{text-align:right}
  .text-lg{font-size:1.125rem} .text-2xl{font-size:1.5rem} .text-3xl{font-size:1.875rem}
  .font-bold{font-weight:700} .font-extrabold{font-weight:800}
  .grid{display:grid} .grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))} .gap-6{gap:1.5rem}
  .h-8{height:2rem}
  #pledgeContent,#certPaper,#ctaSection{max-width:190mm;margin:0 auto;}
</style>
</head><body class="print-a4">` + content + `</body></html>`;

      const iframe = document.createElement('iframe');
      iframe.style.position='fixed'; iframe.style.right='0'; iframe.style.bottom='0';
      iframe.style.width='0'; iframe.style.height='0'; iframe.style.border='0';
      document.body.appendChild(iframe);

      const doc = iframe.contentDocument || iframe.contentWindow.document;
      doc.open(); doc.write(html); doc.close();

      function doPrint(){
        try{ iframe.contentWindow.focus(); iframe.contentWindow.print(); }catch(e){
          const w=window.open('','PRINT','height=700,width=900');
          w.document.open(); w.document.write(html); w.document.close();
          w.focus(); w.print();
        }
        setTimeout(()=>{ try{ document.body.removeChild(iframe); }catch(e){} }, 2000);
      }

      if (doc.fonts && doc.fonts.ready) { doc.fonts.ready.then(()=>setTimeout(doPrint,150)); }
      else { iframe.onload = ()=>setTimeout(doPrint,150); }
    }

    // Reports persistence
    const tbody=document.getElementById('reportsBody');
    function loadReports(){const arr=JSON.parse(localStorage.getItem('rifqReports')||'[]');tbody.innerHTML='';arr.forEach(r=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td class="px-3 py-2">${r.date||''}</td>
                    <td class="px-3 py-2">${r.class||''}</td>
                    <td class="px-3 py-2">${r.place||''}</td>
                    <td class="px-3 py-2">${r.type||''}</td>
                    <td class="px-3 py-2">${r.desc||''}</td>
                    <td class="px-3 py-2">${r.action||''}</td>
                    <td class="px-3 py-2">${r.ref||''}</td>`;
      tbody.appendChild(tr);
    })}
    function saveReport(data){const arr=JSON.parse(localStorage.getItem('rifqReports')||'[]');arr.push(data);localStorage.setItem('rifqReports',JSON.stringify(arr));loadReports()}
    function exportReports(){const arr=JSON.parse(localStorage.getItem('rifqReports')||'[]');if(!arr.length){alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª');return}
      const header=Object.keys(arr[0]);
      const csv=[header.join(',')].concat(arr.map(o=>header.map(k=>`"${String(o[k]??'').replace(/"/g,'""')}"`).join(','))).join('\n');
      const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='rifq_reports.csv';a.click();URL.revokeObjectURL(url)}
    function clearReports(){if(confirm('Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù„Ø§ØºØ§ØªØŸ')){localStorage.removeItem('rifqReports');loadReports()}}

    document.getElementById('reportForm').addEventListener('submit',e=>{e.preventDefault();
      const fd=new FormData(e.target);const data=Object.fromEntries(fd.entries());saveReport(data);e.target.reset();closeReportModal();
      alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨Ù„Ø§Øº ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² (Ù…Ø­Ù„ÙŠÙ‹Ø§).')
    });

    // Settings persistence
    document.getElementById('settingsForm').addEventListener('submit',e=>{e.preventDefault();
      const fd=new FormData(e.target);const s=Object.fromEntries(fd.entries());localStorage.setItem('rifqSettings',JSON.stringify(s));applySettings();closeSettings();
    });
    function applySettings(){const s=JSON.parse(localStorage.getItem('rifqSettings')||'{}');
      document.getElementById('ministryName').textContent=s.ministry||'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…';
      document.getElementById('eduAdmin').textContent='Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…: '+(s.edu||'â€”');
      document.getElementById('schoolName').textContent='Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: '+(s.school||'â€”');

      const parts=[];
      const defaultCredit = 'Ø¨Ø±Ù…Ø¬Ø©: Ø£/ ÙØ§Ø·Ù…Ø© Ù‡Ø²Ø§Ø²ÙŠ';
      if (s.footer && s.footer.trim()) {
        const credit = s.footerLink
          ? `<a href="${s.footerLink}" target="_blank" rel="noopener noreferrer" class="underline decoration-dotted">${s.footer}</a>`
          : s.footer;
        parts.push(credit);
      } else {
        parts.push(defaultCredit);
      }
      if (s.principal && s.principal.trim()) {
        parts.push('Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: ' + s.principal);
      }
      document.getElementById('footerLine').innerHTML = parts.join(' â€¢ ');

      const logo=document.getElementById('schoolLogo');
      if(s.logo){logo.src=s.logo;logo.classList.remove('hidden')} else {logo.classList.add('hidden')}
    }

    // Today date in certificate
    function setToday(){const d=new Date();const f=d.toLocaleDateString('ar-SA',{year:'numeric',month:'long',day:'numeric'});document.getElementById('today').textContent=f}
    window.addEventListener('DOMContentLoaded', setToday);

    // Sparkles
    function createSparkle(){const s=document.createElement('div');s.textContent='âœ¨';s.style.position='fixed';s.style.left=Math.random()*window.innerWidth+'px';s.style.top=Math.random()*window.innerHeight+'px';s.style.fontSize='18px';s.style.pointerEvents='none';s.style.opacity='0.85';s.style.animation='sparkle 2s ease-out forwards';document.body.appendChild(s);setTimeout(()=>s.remove(),2000)}
    const style=document.createElement('style');style.textContent='@keyframes sparkle{0%{opacity:1;transform:scale(0) rotate(0)}50%{opacity:1;transform:scale(1) rotate(180deg)}100%{opacity:0;transform:scale(0) rotate(360deg)}}';document.head.appendChild(style);
    window.addEventListener('DOMContentLoaded',()=>{applySettings();loadReports();setInterval(createSparkle,3000)})
  </script>
</body>
</html>
